---
const banners = [
  { id: 1, title: 'Banner 1', image: '/public/81il.png' },
  { id: 2, title: 'Banner 2', image: '/public/81il.png' },
  { id: 3, title: 'Banner 3', image: '/public/81il.png' },
  { id: 4, title: 'Banner 4', image: '/public/81il.png' },
  { id: 5, title: 'Banner 5', image: '/public/81il.png' },
];
---

<div class="banner-carousel">
  <div class="banners">
    <div class="banner-container prev">
      <img src={banners[banners.length - 1].image} alt="Previous Banner" class="banner">
      <p class="banner-title">{banners[banners.length - 1].title}</p>
    </div>
    <div class="banner-container current">
      <img src={banners[0].image} alt="Current Banner" class="banner">
      <p class="banner-title">{banners[0].title}</p>
    </div>
    <div class="banner-container next">
      <img src={banners[1].image} alt="Next Banner" class="banner">
      <p class="banner-title">{banners[1].title}</p>
    </div>
  </div>
  <button class="arrow left"></button>
  <button class="arrow right"></button>
</div>

<style>
  .banner-carousel {
    position: relative;
    width: 100%;
    height: 400px;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    background-color: #2a2a2e;
  }

  .banners {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
  }

  .banner-container {
    position: absolute;
    transition: transform 0.5s ease, opacity 0.5s ease, filter 0.5s ease;
  }

  .banner {
    width: 500px;
    height: 281px;
    object-fit: cover;
    border-radius: 10px;
  }

  .banner-container.prev {
    transform: translateX(-350px) scale(0.8);
    filter: brightness(0.5);
    z-index: 0;
  }
  
  .banner-container.prev .banner {
    background-color: #808000;
  }

  .banner-container.current {
    transform: translateX(0) scale(1);
    opacity: 1;
    z-index: 1;
  }
  
  .banner-container.current .banner {
    box-shadow: 0 0 35px 5px #32cd32;
  }

  .banner-container.next {
    transform: translateX(350px) scale(0.8);
    filter: brightness(0.5);
    z-index: 0;
  }
  
  .banner-container.next .banner {
    background-color: #8b0000;
  }
  
  .banner-title {
    text-align: center;
    margin-top: 10px;
    color: white;
    font-size: 1.2rem;
  }

  .arrow {
    position: absolute;
    top: 40%;
    transform: translateY(-50%);
    background: transparent;
    border: none;
    cursor: pointer;
    z-index: 2;
  }

  .arrow.left {
    left: calc(50% - 220px);
    width: 0; 
    height: 0; 
    border-top: 20px solid transparent;
    border-bottom: 20px solid transparent;
    border-right: 20px solid #d1c7a8;
  }

  .arrow.right {
    right: calc(50% - 220px);
    width: 0; 
    height: 0; 
    border-top: 20px solid transparent;
    border-bottom: 20px solid transparent;
    border-left: 20px solid #d1c7a8;
  }
</style>

<script is:inline>
  document.addEventListener('astro:page-load', () => {
    const bannersData = [
      { id: 1, title: 'Banner 1', image: '/81il.png' },
      { id: 2, title: 'Banner 2', image: '/81il.png' },
      { id: 3, title: 'Banner 3', image: '/81il.png' },
      { id: 4, title: 'Banner 4', image: '/81il.png' },
      { id: 5, title: 'Banner 5', image: '/81il.png' },
    ];
    let currentIndex = 0;
    let isAnimating = false;

    const rightArrow = document.querySelector('.arrow.right');
    const leftArrow = document.querySelector('.arrow.left');

    function handleNext() {
      if (isAnimating) return;
      isAnimating = true;

      currentIndex = (currentIndex + 1) % bannersData.length;

      const prevEl = document.querySelector('.banner-container.prev');
      const currentEl = document.querySelector('.banner-container.current');
      const nextEl = document.querySelector('.banner-container.next');

      prevEl.classList.remove('prev');
      prevEl.classList.add('next');
      
      currentEl.classList.remove('current');
      currentEl.classList.add('prev');
      
      nextEl.classList.remove('next');
      nextEl.classList.add('current');

      setTimeout(() => {
        const newNextIndex = (currentIndex + 1) % bannersData.length;
        const newNextEl = document.querySelector('.banner-container.next');
        newNextEl.querySelector('.banner').src = bannersData[newNextIndex].image;
        newNextEl.querySelector('.banner-title').textContent = bannersData[newNextIndex].title;
        isAnimating = false;
      }, 500);
    }
    
    function handlePrev() {
      if (isAnimating) return;
      isAnimating = true;

      currentIndex = (currentIndex - 1 + bannersData.length) % bannersData.length;

      const prevEl = document.querySelector('.banner-container.prev');
      const currentEl = document.querySelector('.banner-container.current');
      const nextEl = document.querySelector('.banner-container.next');
      
      prevEl.classList.remove('prev');
      prevEl.classList.add('current');

      currentEl.classList.remove('current');
      currentEl.classList.add('next');

      nextEl.classList.remove('next');
      nextEl.classList.add('prev');
      
      setTimeout(() => {
        const newPrevIndex = (currentIndex - 1 + bannersData.length) % bannersData.length;
        const newPrevEl = document.querySelector('.banner-container.prev');
        newPrevEl.querySelector('.banner').src = bannersData[newPrevIndex].image;
        newPrevEl.querySelector('.banner-title').textContent = bannersData[newPrevIndex].title;
        isAnimating = false;
      }, 500);
    }

    rightArrow.addEventListener('click', handleNext);
    leftArrow.addEventListener('click', handlePrev);
  });
</script>
